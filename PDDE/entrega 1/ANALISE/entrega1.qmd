---
title: "Cecampe-CO/PDDE"
subtitle: "Entrega 1"
author: "Tailine J. S. Nonato"
format: pdf
---

# Objetivo

Organizar os dados para identificar as escolas que não participaram do PDDE 2023. Depois de algum tratamento estas escolas serão objeto de monitoramento (Por que não estão no programa? Como o CECAMPE CO – MONITORAMENTO pode ajudá-las a ingressar no programa?)

```{r}
#| message: false
#| warning: false
#| echo: false
if (!require(pacman)) install.packages("pacman")
pacman::p_load(tidyverse, knitr, openxlsx)
#setwd("C:/Users/User/Documents/GitHub/gradest/PDDE/entrega 1")
setwd("/Users/tailine.nonato/Documents/VSCode/PDDE/entrega 1")
```

```{r}
dados <- read.csv("ETL/dados/base_completa.csv")
```

1. Número de escolas públicas segundo a dependência administrativa e a UF – Centro-Oeste
- Colunas: TP_DEPENDENCIA
- Linhas: NO_UF

```{r}	
#| warning: false
#| message: false
#| echo: false
tab1 <- dados %>% 
        group_by(NO_UF, TP_DEPENDENCIA) %>% 
        summarise(n = n()) %>% 
        spread(TP_DEPENDENCIA, n, fill = 0) %>% 
        select(NO_UF, `1`, `2`, `3`, `4`) %>% 
        rename(`Federal` = `1`, `Estadual` = `2`, `Municipal` = `3`, `Privada` = `4`)
kable(tab1)
```	

2. Número de escolas públicas segundo a situação de funcionamento e a UF – Centro-Oeste
- Coluna: TP_SITUACAO_FUNCIONAMENTO
- Linhas: NO_UF

```{r}
#| warning: false
#| message: false
#| echo: false
tab2 <- dados %>% 
  group_by(NO_UF, TP_SITUACAO_FUNCIONAMENTO) %>% 
  summarise(n = n()) %>% 
  spread(TP_SITUACAO_FUNCIONAMENTO, n, fill = 0) %>% 
  {if (all(c("1", "2", "3", "4", "5") %in% colnames(.))) select(., NO_UF, `1`, `2`, `3`, `4`, `5`) else .} %>% 
  rename_at(vars(matches("^[12345]$")), 
            ~c("Em atividade", "Paralisada", "Extinta", "Em atividade de educação especial", "Paralisada de educação especial")[match(., c("1", "2", "3", "4", "5"))])

kable(tab2)
```

3. Número de escolas públicas segundo a localização e a UF – Centro-Oeste (identificação das escolas em localização diferenciada)
- Coluna: TP_LOCALIZACAO_DIFERENCIADA
- Linhas: NO_UF

```{r}
#| warning: false
#| message: false
#| echo: false
tab3 <- dados %>% 
  group_by(NO_UF, TP_LOCALIZACAO_DIFERENCIADA) %>% 
  summarise(n = n()) %>% 
  spread(TP_LOCALIZACAO_DIFERENCIADA, n, fill = 0) %>% 
  {if (all(c("0","1", "2", "3", "4") %in% colnames(.))) select(., NO_UF, `0`,`1`, `2`, `3`, `4`) else .} %>% 
  rename_at(vars(matches("^[01234]$")), 
            ~c("Não diferenciada", "Urbana", "Rural", "Rural de difícil acesso", "Indígena")[match(., c("0","1", "2", "3", "4"))])

kable(tab3)
```

## PDDE 2023 (Consulta Escola/FNDE)

1. Número de escolas participantes do PDDE: Escolas PAGAS em 2023
- Coluna: Situação


## Exportando as tabelas para um arquivo Excel

```{r}
#| warning: false
#| message: false
#| echo: false

wb <- createWorkbook()
addWorksheet(wb, "tab1")
writeData(wb, "tab1", tab1)
addWorksheet(wb, "tab2")
writeData(wb, "tab2", tab2)
addWorksheet(wb, "tab3")
writeData(wb, "tab3", tab3)
saveWorkbook(wb, "dados/relatorio.xlsx", overwrite = TRUE)
```