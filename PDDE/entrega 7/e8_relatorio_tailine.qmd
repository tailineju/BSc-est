---
title: "Centro Colaborador de Apoio ao Monitoramento e à Gestão de Programas Educacionais do Centro Oeste"
subtitle: "Monitoramento e Apoio às UEx do PDDE Básico e  PDDE Ações Integradas"
author: "Tailine J. S. Nonato"
format: pdf
---

```{r}
#| echo: false
#| message: false
#| warning: false

if (!require(pacman)) install.packages("pacman")
pacman::p_load(vroom,tidyverse, knitr, openxlsx, kableExtra)
setwd("C:/Users/User/Documents/GitHub/gradest-1/PDDE/entrega 7")

dados <- read.csv("base_completa_2024.csv")
dados_pagos <- dados %>% filter(fonte == "pdde_pagos")  %>% distinct(CO_ENTIDADE, .keep_all = TRUE)
dados_nao_pagos <- dados %>% filter(fonte == "pdde_naopagos")  %>% distinct(CO_ENTIDADE, .keep_all = TRUE)

#escolas que estão em pagos e nao pagos
dados_dup <- dados_pagos %>% 
        inner_join(dados_nao_pagos, by = "CO_ENTIDADE") %>% 
        distinct(CO_ENTIDADE, .keep_all = TRUE)

#escolas que estão em "pagos" e não estao em "nao_pagos"
escolas_somente_pagos <- dados_pagos %>% 
        anti_join(dados_nao_pagos, by = "CO_ENTIDADE")

escolas_somente_nao_pagos <- dados_nao_pagos %>% 
        anti_join(dados_pagos, by = "CO_ENTIDADE")

dados <- rbind(dados_pagos, escolas_somente_nao_pagos)
```

# Visão Geral 
## Tabela 1 - Checagem no número de alunos entre o Censo Escolar e o PDDE (Centro-Oeste, 2024)
```{r}
#| echo: false
#| warning: false
#| message: false

#first of all - check if Quantidade_ALunos and QT_MAT_BAS are the same for schools

dados$alunos1 <- ifelse(dados$QT_MAT_BAS == dados$Quantidade.Alunos, "Igual", "Diferente")

dados$alunos2 <- dados$QT_MAT_BAS - dados$Quantidade.Alunos

tab0 <- dados %>%
        filter(alunos2!=0)%>%
        group_by(CO_ENTIDADE,alunos2,QT_MAT_BAS,Quantidade.Alunos) %>%
        summarize(n=n()) %>%
        arrange(desc(alunos2))
summary(as.numeric(dados$alunos2))

#33 acima de 10 alunos
#1838 abaixo de 10 alunos
        #filter schools that are part of PDDE
tab1 <- dados %>% 
        filter(fonte %in% c("pdde_pagos","pdde_naopagos"), TP_SITUACAO_FUNCIONAMENTO == 1) %>%
        group_by(alunos1) %>% 
        summarise(Freq.Absoluta = n(), .groups = 'drop') %>% 
        mutate(Freq.Relativa = scales::percent(Freq.Absoluta/sum(Freq.Absoluta))) %>% 
        select(alunos1, Freq.Absoluta, Freq.Relativa) %>% 
        mutate_if(is.numeric, ~format(., decimal.mark = ",", big.mark = "."))

tab1 %>%
        kable(align = "l") %>%
        kable_styling(full_width = F, position = "left")%>%
        footnote(general = "Consulta Escola 2024; Censo Escolar 2023", general_title = "Fonte:")
```

```{r}	
#| echo: false
#| warning: false
#| message: false

dados$UEx <- ifelse(dados$`CNPJ.Executora` == dados$`CNPJ.Município.SEDUC`, "Sem UEx", "Com UEx")

dados$CNPJ<- as.numeric(substr(dados$CNPJ.Executora, start=2,stop=10))

dados$UEx <- ifelse(is.na(dados$CNPJ), "Sem UEx", dados$UEx)

dados$UEx <- factor(dados$UEx, levels = c("Sem UEx", "Com UEx"))

dados$alunos <- ifelse(as.numeric(dados$Quantidade.Alunos) < 50, "<50", "50+")
dados$alunos <- factor(dados$alunos, levels = c( "<50","50+"))

# definindo todas as tabelas
tab2 <- dados %>% 
        filter(TP_LOCALIZACAO_DIFERENCIADA == 1) %>%
        group_by(NO_UF, TP_DEPENDENCIA) %>% 
        summarise(n = n(), .groups = 'drop') %>% 
        spread(TP_DEPENDENCIA, n, fill = 0) %>% 
        mutate_at(vars(`2`, `3`), as.numeric) %>% 
        select(NO_UF, `2`, `3`) %>% 
        rename(`Estadual` = `2`, `Municipal` = `3`) %>%
        mutate(Total = rowSums(select(., -NO_UF))) %>%
        add_row(NO_UF = "Total", 
                Estadual = sum(.$Estadual, na.rm = TRUE), 
                Municipal = sum(.$Municipal, na.rm = TRUE), 
                Total = sum(.$Total, na.rm = TRUE))%>%
        mutate_if(is.numeric, ~format(., decimal.mark = ",", big.mark = "."))

tab3 <- dados %>% 
        filter(TP_LOCALIZACAO_DIFERENCIADA == 1) %>%
        group_by(NO_UF, UEx) %>%
        summarise(n = n(), .groups = 'drop') %>%
        spread(UEx, n, fill = 0) %>%
        mutate_at(vars(`Com UEx`, `Sem UEx`), as.numeric) %>%
        select(NO_UF, `Com UEx`, `Sem UEx`) %>%
        mutate(Total = rowSums(select(., -NO_UF))) %>%
        add_row(NO_UF = "Total", 
                `Com UEx` = sum(.$`Com UEx`, na.rm = TRUE), 
                `Sem UEx` = sum(.$`Sem UEx`, na.rm = TRUE), 
                Total = sum(.$Total, na.rm = TRUE))%>%
        mutate_if(is.numeric, ~format(., decimal.mark = ",", big.mark = "."))

tab4 <- dados %>% 
        filter(TP_LOCALIZACAO_DIFERENCIADA == 1) %>%
        group_by(NO_UF, alunos) %>%
        summarise(n = n(), .groups = 'drop') %>%
        spread(alunos, n, fill = 0) %>%
        mutate_at(vars(`<50`,`50+`), as.numeric) %>%
        select(NO_UF, `<50`,`50+`) %>%
        mutate(Total = rowSums(select(., -NO_UF))) %>%
        add_row(NO_UF = "Total", 
                `50+` = sum(.$`50+`, na.rm = TRUE), 
                `<50` = sum(.$`<50`, na.rm = TRUE), 
                Total = sum(.$Total, na.rm = TRUE))%>%
        mutate_if(is.numeric, ~format(., decimal.mark = ",", big.mark = "."))

tab5 <- dados %>% 
        filter(TP_LOCALIZACAO_DIFERENCIADA == 1) %>%
        group_by(NO_UF, fonte) %>%
        summarise(n = n(), .groups = 'drop') %>%
        spread(fonte, n, fill = 0) %>%
        mutate_at(vars(`pdde_naopagos`,`pdde_pagos`), as.numeric) %>%
        select(NO_UF, `pdde_naopagos`,`pdde_pagos`) %>%
        rename(`Não pagos` = `pdde_naopagos`,
               `Pagos` = `pdde_pagos`) %>%
        mutate(Total = rowSums(select(., -NO_UF))) %>%
        add_row(NO_UF = "Total", 
                `Não pagos` = sum(.$`Não pagos`, na.rm = TRUE), 
                `Pagos` = sum(.$`Pagos`, na.rm = TRUE), 
                Total = sum(.$Total, na.rm = TRUE)) %>%
        mutate_if(is.numeric, ~format(., decimal.mark = ",", big.mark = "."))
       
tab6 <- dados %>% 
        filter(TP_LOCALIZACAO_DIFERENCIADA == 2) %>%
        group_by(NO_UF, TP_DEPENDENCIA) %>% 
        summarise(n = n(), .groups = 'drop') %>% 
        spread(TP_DEPENDENCIA, n, fill = 0) %>% 
        mutate_at(vars(`2`, `3`), as.numeric) %>% 
        select(NO_UF, `2`, `3`) %>% 
        rename(`Estadual` = `2`, `Municipal` = `3`) %>%
        mutate(Total = rowSums(select(., -NO_UF))) %>%
        add_row(NO_UF = "Total", 
                Estadual = sum(.$Estadual, na.rm = TRUE), 
                Municipal = sum(.$Municipal, na.rm = TRUE), 
                Total = sum(.$Total, na.rm = TRUE))%>%
        mutate_if(is.numeric, ~format(., decimal.mark = ",", big.mark = "."))
tab7 <- dados %>% 
        filter(TP_LOCALIZACAO_DIFERENCIADA == 2) %>%
        group_by(NO_UF, UEx) %>%
        summarise(n = n(), .groups = 'drop') %>%
        spread(UEx, n, fill = 0) %>%
        mutate_at(vars(`Com UEx`, `Sem UEx`), as.numeric) %>%
        select(NO_UF, `Com UEx`, `Sem UEx`) %>%
        mutate(Total = rowSums(select(., -NO_UF))) %>%
        add_row(NO_UF = "Total", 
                `Com UEx` = sum(.$`Com UEx`, na.rm = TRUE), 
                `Sem UEx` = sum(.$`Sem UEx`, na.rm = TRUE), 
                Total = sum(.$Total, na.rm = TRUE))%>%
        mutate_if(is.numeric, ~format(., decimal.mark = ",", big.mark = "."))

tab8 <- dados %>% 
        filter(TP_LOCALIZACAO_DIFERENCIADA == 2) %>%
        group_by(NO_UF, alunos) %>%
        summarise(n = n(), .groups = 'drop') %>%
        spread(alunos, n, fill = 0) %>%
        mutate_at(vars(`<50`,`50+`), as.numeric) %>%
        select(NO_UF, `<50`,`50+`) %>%
        mutate(Total = rowSums(select(., -NO_UF))) %>%
        add_row(NO_UF = "Total", 
                `50+` = sum(.$`50+`, na.rm = TRUE), 
                `<50` = sum(.$`<50`, na.rm = TRUE), 
                Total = sum(.$Total, na.rm = TRUE))%>%
        mutate_if(is.numeric, ~format(., decimal.mark = ",", big.mark = "."))

tab9 <- dados %>% 
        filter(TP_LOCALIZACAO_DIFERENCIADA == 2) %>%
        group_by(NO_UF, fonte) %>%
        summarise(n = n(), .groups = 'drop') %>%
        spread(fonte, n, fill = 0) %>%
        mutate_at(vars(`pdde_naopagos`,`pdde_pagos`), as.numeric) %>%
        select(NO_UF, `pdde_naopagos`,`pdde_pagos`) %>%
        rename(`Não pagos` = `pdde_naopagos`,
               `Pagos` = `pdde_pagos`) %>%
        mutate(Total = rowSums(select(., -NO_UF))) %>%
        add_row(NO_UF = "Total", 
                `Não pagos` = sum(.$`Não pagos`, na.rm = TRUE), 
                `Pagos` = sum(.$`Pagos`, na.rm = TRUE), 
                Total = sum(.$Total, na.rm = TRUE)) %>%
        mutate_if(is.numeric, ~format(., decimal.mark = ",", big.mark = "."))
tab10 <- dados %>% 
        filter(TP_LOCALIZACAO_DIFERENCIADA == 3) %>%
        group_by(NO_UF, TP_DEPENDENCIA) %>% 
        summarise(n = n(), .groups = 'drop') %>% 
        spread(TP_DEPENDENCIA, n, fill = 0) %>% 
        mutate_at(vars(`2`, `3`), as.numeric) %>% 
        select(NO_UF, `2`, `3`) %>% 
        rename(`Estadual` = `2`, `Municipal` = `3`) %>%
        mutate(Total = rowSums(select(., -NO_UF))) %>%
        add_row(NO_UF = "Total", 
                Estadual = sum(.$Estadual, na.rm = TRUE), 
                Municipal = sum(.$Municipal, na.rm = TRUE), 
                Total = sum(.$Total, na.rm = TRUE))%>%
        mutate_if(is.numeric, ~format(., decimal.mark = ",", big.mark = "."))


tab11 <- dados %>% 
        filter(TP_LOCALIZACAO_DIFERENCIADA == 3) %>%
        group_by(NO_UF, UEx) %>%
        summarise(n = n(), .groups = 'drop') %>%
        spread(UEx, n, fill = 0) %>%
        mutate_at(vars(`Com UEx`, `Sem UEx`), as.numeric) %>%
        select(NO_UF, `Com UEx`, `Sem UEx`) %>%
        mutate(Total = rowSums(select(., -NO_UF))) %>%
        add_row(NO_UF = "Total", 
                `Com UEx` = sum(.$`Com UEx`, na.rm = TRUE), 
                `Sem UEx` = sum(.$`Sem UEx`, na.rm = TRUE), 
                Total = sum(.$Total, na.rm = TRUE))%>%
        mutate_if(is.numeric, ~format(., decimal.mark = ",", big.mark = "."))


tab12 <- dados %>% 
        filter(TP_LOCALIZACAO_DIFERENCIADA == 3) %>%
        group_by(NO_UF, alunos) %>%
        summarise(n = n(), .groups = 'drop') %>%
        spread(alunos, n, fill = 0) %>%
        mutate_at(vars(`<50`,`50+`), as.numeric) %>%
        select(NO_UF, `<50`,`50+`) %>%
        mutate(Total = rowSums(select(., -NO_UF))) %>%
        add_row(NO_UF = "Total", 
                `50+` = sum(.$`50+`, na.rm = TRUE), 
                `<50` = sum(.$`<50`, na.rm = TRUE), 
                Total = sum(.$Total, na.rm = TRUE))%>%
        mutate_if(is.numeric, ~format(., decimal.mark = ",", big.mark = "."))
tab13 <- dados %>% 
        filter(TP_LOCALIZACAO_DIFERENCIADA == 3) %>%
        group_by(NO_UF, fonte) %>%
        summarise(n = n(), .groups = 'drop') %>%
        spread(fonte, n, fill = 0) %>%
        mutate_at(vars(`pdde_naopagos`,`pdde_pagos`), as.numeric) %>%
        select(NO_UF, `pdde_naopagos`,`pdde_pagos`) %>%
        rename(`Não pagos` = `pdde_naopagos`,
               `Pagos` = `pdde_pagos`) %>%
        mutate(Total = rowSums(select(., -NO_UF))) %>%
        add_row(NO_UF = "Total", 
                `Não pagos` = sum(.$`Não pagos`, na.rm = TRUE), 
                `Pagos` = sum(.$`Pagos`, na.rm = TRUE), 
                Total = sum(.$Total, na.rm = TRUE)) %>%
        mutate_if(is.numeric, ~format(., decimal.mark = ",", big.mark = "."))

tab14 <- dados %>% 
        filter(TP_LOCALIZACAO_DIFERENCIADA == 8) %>%
        group_by(NO_UF, TP_DEPENDENCIA) %>% 
        summarise(n = n(), .groups = 'drop') %>% 
        spread(TP_DEPENDENCIA, n, fill = 0) %>% 
        mutate_at(vars(`3`), as.numeric) %>% 
        select(NO_UF, `3`) %>% 
        rename(`Municipal` = `3`) %>%
        mutate(Total = rowSums(select(., -NO_UF))) %>%
        add_row(NO_UF = "Total",
                Municipal = sum(.$Municipal, na.rm = TRUE), 
                Total = sum(.$Total, na.rm = TRUE))%>%
        mutate_if(is.numeric, ~format(., decimal.mark = ",", big.mark = "."))

tab15 <- dados %>% 
        filter(TP_LOCALIZACAO_DIFERENCIADA == 8) %>%
        group_by(NO_UF, UEx) %>%
        summarise(n = n(), .groups = 'drop') %>%
        spread(UEx, n, fill = 0) %>%
        mutate_at(vars(`Com UEx`, `Sem UEx`), as.numeric) %>%
        select(NO_UF, `Com UEx`, `Sem UEx`) %>%
        mutate(Total = rowSums(select(., -NO_UF))) %>%
        add_row(NO_UF = "Total", 
                `Com UEx` = sum(.$`Com UEx`, na.rm = TRUE), 
                `Sem UEx` = sum(.$`Sem UEx`, na.rm = TRUE), 
                Total = sum(.$Total, na.rm = TRUE))%>%
        mutate_if(is.numeric, ~format(., decimal.mark = ",", big.mark = "."))

tab16 <- dados %>% 
        filter(TP_LOCALIZACAO_DIFERENCIADA == 8) %>%
        group_by(NO_UF, alunos) %>%
        summarise(n = n(), .groups = 'drop') %>%
        spread(alunos, n, fill = 0) %>%
        mutate_at(vars(`<50`,`50+`), as.numeric) %>%
        select(NO_UF, `<50`,`50+`) %>%
        mutate(Total = rowSums(select(., -NO_UF))) %>%
        add_row(NO_UF = "Total", 
                `50+` = sum(.$`50+`, na.rm = TRUE), 
                `<50` = sum(.$`<50`, na.rm = TRUE), 
                Total = sum(.$Total, na.rm = TRUE))%>%
        mutate_if(is.numeric, ~format(., decimal.mark = ",", big.mark = "."))


tab17 <- dados %>% 
        filter(TP_LOCALIZACAO_DIFERENCIADA == 8) %>%
        group_by(NO_UF, fonte) %>%
        summarise(n = n(), .groups = 'drop') %>%
        spread(fonte, n, fill = 0) %>%
        mutate_at(vars(`pdde_naopagos`,`pdde_pagos`), as.numeric) %>%
        select(NO_UF, `pdde_naopagos`,`pdde_pagos`) %>%
        rename(`Não pagos` = `pdde_naopagos`,
               `Pagos` = `pdde_pagos`) %>%
        mutate(Total = rowSums(select(., -NO_UF))) %>%
        add_row(NO_UF = "Total", 
                `Não pagos` = sum(.$`Não pagos`, na.rm = TRUE), 
                `Pagos` = sum(.$`Pagos`, na.rm = TRUE), 
                Total = sum(.$Total, na.rm = TRUE)) %>%
        mutate_if(is.numeric, ~format(., decimal.mark = ",", big.mark = "."))
```	


## Tabela 2 - Visão geral das escolas públicas em área de assentamento (Centro-Oeste, 2024)
```{r}
#| echo: false
#| warning: false
#| message: false

nomes<- c("UF", "Estadual", "Municipal", "Com UEx", "Sem UEx", "50+", "<50", "Pagos", "Não pagos", "Total")

assentamento <- data.frame(tab2[,1:3], tab3[,2:3], tab4[,2:3], tab5[,2:4])
colnames(assentamento) <- nomes

kable(assentamento, align = "l") %>%
        kable_styling(full_width = F, position = "left", font_size=8)%>%
        column_spec(1, border_right=TRUE)%>%
        column_spec(3, border_right=TRUE)%>%
        column_spec(5, border_right=TRUE)%>%
        column_spec(7, border_right=TRUE)%>%
        column_spec(9, border_right=TRUE)%>%
        footnote(general = "Consulta Escola 2024; Censo Escolar 2023", general_title = "Fonte:")

```	

## Tabela 3 - Visão geral das escolas públicas em terras indígenas (Centro-Oeste, 2024)
```{r}	
#| echo: false
#| warning: false
#| message: false

indigenas <- data.frame(tab6[,1:3], tab7[,2:3], tab8[,2:3], tab9[,2:4])
colnames(indigenas) <- nomes

kable(indigenas, align = "l") %>%
         kable_styling(full_width = F, position = "left", font_size=8)%>%
        column_spec(1, border_right=TRUE)%>%
        column_spec(3, border_right=TRUE)%>%
        column_spec(5, border_right=TRUE)%>%
        column_spec(7, border_right=TRUE)%>%
        column_spec(9, border_right=TRUE)%>%
        footnote(general = "Consulta Escola 2024; Censo Escolar 2023", general_title = "Fonte:")
```

## Tabela 4 - Visão geral das escolas públicas em áreas remanescentes de quilombos (Centro-Oeste, 2024)
```{r}	
#| echo: false
#| warning: false
#| message: false
quilombos <- data.frame(tab10[,1:3], tab11[,2:3], tab12[,2:3], tab13[,2:4])
colnames(quilombos) <- nomes

kable(quilombos, align = "l") %>%
         kable_styling(full_width = F, position = "left", font_size=8)%>%
        column_spec(1, border_right=TRUE)%>%
        column_spec(3, border_right=TRUE)%>%
        column_spec(5, border_right=TRUE)%>%
        column_spec(7, border_right=TRUE)%>%
        column_spec(9, border_right=TRUE)%>%
        footnote(general = "Consulta Escola 2024; Censo Escolar 2023", general_title = "Fonte:")
```

## Tabela 5 - Visão geral das escolas públicas em áreas de comunidades tradicionais (Centro-Oeste, 2024)
```{r}	
#| echo: false
#| warning: false
#| message: false
tradicionais <- data.frame(tab14[,1:3], tab15[,2:3], tab16[,2:3], tab17[,2:4])
colnames(tradicionais) <- nomes

kable(tradicionais, align = "l") %>%
        kable_styling(full_width = F, position = "left", font_size=8)%>%
        column_spec(1, border_right=TRUE)%>%
        column_spec(3, border_right=TRUE)%>%
        column_spec(5, border_right=TRUE)%>%
        column_spec(7, border_right=TRUE)%>%
        column_spec(9, border_right=TRUE)%>%
        footnote(general = "Consulta Escola 2024; Censo Escolar 2023", general_title = "Fonte:")
```	

# Análise da Destinação dos Repasses (Centro-Oeste, 2024)

## Tabela 6 - Número de escolas que constam somente como "pagas" segundo a destinação dos repasses do PDDE (Centro-Oeste, 2024)
```{r}
#| echo: false
#| warning: false
#| message: false

tab18 <- escolas_somente_pagos %>%
        group_by(Destinação) %>% 
        summarise(n = n(), .groups = 'drop') %>% 
        mutate(n = format(n, big.mark = ".", decimal.mark = ","))

kable(tab18, align = "l") %>%
        kable_styling(full_width = F, position = "left")%>%
        footnote(general = "Consulta Escola 2024; Censo Escolar 2023", general_title = "Fonte:")
```

## Tabela 7 - Número de escolas que constam somente como "não pagas" segundo a destinação dos repasses do PDDE (Centro-Oeste, 2024)
```{r}
#| echo: false
#| warning: false
#| message: false
tab19 <- escolas_somente_nao_pagos %>%
        group_by(Destinação) %>% 
        summarise(n = n(), .groups = 'drop') %>% 
        mutate(n = format(n, big.mark = ".", decimal.mark = ","))

kable(tab19, align = "l") %>%
        kable_styling(full_width = F, position = "left")%>%
        footnote(general = "Consulta Escola 2024; Censo Escolar 2023", general_title = "Fonte:")
```

## Tabela 8 - Número de escolas que constam como "pagas" e "não pagas" segundo a destinação dos repasses do PDDE (Centro-Oeste, 2024)
```{r}
#| echo: false
#| warning: false
#| message: false
tab20 <- dados_dup %>%
        group_by(Destinação.x, Destinação.y) %>% 
        summarise(n = n(), .groups = 'drop') %>% 
        mutate(n = format(n, big.mark = ".", decimal.mark = ","))%>%
        rename("Pagos" = Destinação.x, "Não Pagos" = Destinação.y)
#add totals


kable(tab20, align = "l") %>%
        kable_styling(full_width = F, position = "left")%>%
        footnote(general = "Consulta Escola 2024; Censo Escolar 2023", general_title = "Fonte:")
```

## Tabela 9 - Número total de escolas no Consulta Escola (Centro-Oeste, 2024)
```{r}
#| echo: false
#| warning: false
#| message: false
tab21 <- dados %>% 
        summarise(n = n(), .groups = 'drop') %>% 
        mutate(n = format(n, big.mark = ".", decimal.mark = ","))%>%
        rename("Número de escolas" = n)
kable(tab21, align = "l") %>%
        kable_styling(full_width = F, position = "left")%>%
        footnote(general = "Consulta Escola 2024; Censo Escolar 2023", general_title = "Fonte:")
```


# Análise cruzada (UEx e número de alunos)

## Tabela 10 - Número de escolas públicas por UEx e Quantidade de Alunos em cada UF (Centro-Oeste, 2024)
```{r}
#| echo: false
#| warning: false
#| message: false
tab22 <- dados %>% 
        group_by(NO_UF, alunos, UEx) %>%
        summarise(n = n(), .groups = 'drop')
kable(tab22, align = "l") %>%
        kable_styling(full_width = F, position = "left")%>%
        footnote(general = "Consulta Escola 2024; Censo Escolar 2023", general_title = "Fonte:")
```

```{r}	
#| echo: false
#| warning: false
#| message: false

wb <- createWorkbook()


addWorksheet(wb, "assentamento")
writeData(wb, "assentamento", assentamento)

addWorksheet(wb, "indigenas")
writeData(wb, "indigenas", indigenas)


addWorksheet(wb, "quilombos")
writeData(wb, "quilombos", quilombos)


addWorksheet(wb, "tradicionais")
writeData(wb, "tradicionais", tradicionais)


# Save the workbook
saveWorkbook(wb, "e8_planilha_tailine.xlsx", overwrite = TRUE)

```

# Detalhes
## Áreas de Assentamento

### Tabela 2.1 - Número de escolas públicas em Áreas de Assentamento segundo a dependência administrativa e a UF  (Centro-Oeste, 2024)
```{r}	
#| echo: false
#| warning: false
#| message: false

tab2 %>%
  kable(align = "l") %>%
  kable_styling(full_width = F, position = "left")%>%
  footnote(general = "Censo Escolar 2023", general_title = "Fonte:")
```	

### Tabela 2.2 - Número de escolas públicas em Áreas de Assentamento segundo a existência de UEx e a UF  (Centro-Oeste, 2024)

```{r}	
#| echo: false
#| warning: false
#| message: false

tab3 %>%
  kable(align = "l") %>%
  kable_styling(full_width = F, position = "left")%>%
  footnote(general = "Censo Escolar 2023", general_title = "Fonte:")
```

### Tabela 2.3 - Número de escolas públicas em Áreas de Assentamento segundo o número de alunos e a UF (Centro-Oeste, 2024)

```{r}
#| echo: false
#| warning: false
#| message: false

tab4 %>%
        kable(align = "l") %>%
        kable_styling(full_width = F, position = "left")%>%
        footnote(general = "Consulta Escola 2024; Censo Escolar 2023", general_title = "Fonte:")
```	

### Tabela 2.4 - Número de escolas públicas em Áreas de Assentamento segundo o pagamento de parcelas do PDDE e a UF (Centro-Oeste, 2024)

```{r}
#| echo: false
#| warning: false
#| message: false

tab5 %>%
        kable(align = "l") %>%
        kable_styling(full_width = F, position = "left")%>%
        footnote(general = "Consulta Escola 2024; Censo Escolar 2023", general_title = "Fonte:")
```


## Terras Indígenas

### Tabela 3.1 - Número de escolas públicas em Terras Indígenas segundo a dependência administrativa e a UF  (Centro-Oeste, 2024)
```{r}	
#| echo: false
#| warning: false
#| message: false

tab6 %>%
  kable(align = "l") %>%
  kable_styling(full_width = F, position = "left")%>%
  footnote(general = "Censo Escolar 2023", general_title = "Fonte:")
```	

### Tabela 3.2 - Número de escolas públicas em Terras Indígenas segundo a existência de UEx e a UF  (Centro-Oeste, 2024)

```{r}	
#| echo: false
#| warning: false
#| message: false

tab7 %>%
  kable(align = "l") %>%
  kable_styling(full_width = F, position = "left")%>%
  footnote(general = "Censo Escolar 2023", general_title = "Fonte:")
```

### Tabela 3.3 - Número de escolas públicas em Terras Indígenas segundo o número de alunos e a UF (Centro-Oeste, 2024)

```{r}
#| echo: false
#| warning: false
#| message: false

tab8 %>%
        kable(align = "l") %>%
        kable_styling(full_width = F, position = "left")%>%
        footnote(general = "Consulta Escola 2024; Censo Escolar 2023", general_title = "Fonte:")
```	

### Tabela 3.4 - Número de escolas públicas em Terras Indígenas segundo o pagamento de parcelas do PDDE e a UF (Centro-Oeste, 2024)

```{r}
#| echo: false
#| warning: false
#| message: false

tab9 %>%
        kable(align = "l") %>%
        kable_styling(full_width = F, position = "left")%>%
        footnote(general = "Consulta Escola 2024; Censo Escolar 2023", general_title = "Fonte:")
```

## Remanescentes de Quilombos

### Tabela 4.1 - Número de escolas públicas em Áreas Remanescentes de Quilombos segundo a dependência administrativa e a UF  (Centro-Oeste, 2024)
```{r}	
#| echo: false
#| warning: false
#| message: false

tab10 %>%
  kable(align = "l") %>%
  kable_styling(full_width = F, position = "left")%>%
  footnote(general = "Censo Escolar 2023", general_title = "Fonte:")
```	



## Tabela 4.2 - Número de escolas públicas em Áreas Remanescentes de Quilombos segundo a existência de UEx e a UF  (Centro-Oeste, 2024)

```{r}	
#| echo: false
#| warning: false
#| message: false


tab11 %>%
  kable(align = "l") %>%
  kable_styling(full_width = F, position = "left")%>%
  footnote(general = "Censo Escolar 2023", general_title = "Fonte:")
```

## Tabela 4.3 - Número de escolas públicas em Áreas Remanescentes de Quilombos segundo o número de alunos e a UF (Centro-Oeste, 2024)

```{r}
#| echo: false
#| warning: false
#| message: false

tab12 %>%
        kable(align = "l") %>%
        kable_styling(full_width = F, position = "left")%>%
        footnote(general = "Consulta Escola 2024; Censo Escolar 2023", general_title = "Fonte:")
```	

## Tabela 4.5 - Número de escolas públicas em Áreas Remanescentes de Quilombos segundo o pagamento de parcelas do PDDE e a UF (Centro-Oeste, 2024)

```{r}
#| echo: false
#| warning: false
#| message: false

tab13 %>%
        kable(align = "l") %>%
        kable_styling(full_width = F, position = "left")%>%
        footnote(general = "Consulta Escola 2024; Censo Escolar 2023", general_title = "Fonte:")
```


## Comunidades e povos tradicionais


### Tabela 5.1 - Número de escolas públicas em Áreas de Comunidades Tradicionais segundo a dependência administrativa e a UF  (Centro-Oeste, 2024)
```{r}	
#| echo: false
#| warning: false
#| message: false


tab14 %>%
  kable(align = "l") %>%
  kable_styling(full_width = F, position = "left")%>%
  footnote(general = "Censo Escolar 2023", general_title = "Fonte:")
```	

### Tabela 5.2 - Número de escolas públicas em Áreas de Comunidades Tradicionais segundo a existência de UEx e a UF  (Centro-Oeste, 2024)

```{r}	
#| echo: false
#| warning: false
#| message: false


tab15 %>%
  kable(align = "l") %>%
  kable_styling(full_width = F, position = "left")%>%
  footnote(general = "Censo Escolar 2023", general_title = "Fonte:")
```

### Tabela 5.3 - Número de escolas públicas em Áreas de Comunidades Tradicionais segundo o número de alunos e a UF (Centro-Oeste, 2024)

```{r}
#| echo: false
#| warning: false
#| message: false


tab16 %>%
        kable(align = "l") %>%
        kable_styling(full_width = F, position = "left")%>%
        footnote(general = "Consulta Escola 2024; Censo Escolar 2023", general_title = "Fonte:")
```	

### Tabela 5.4 - Número de escolas públicas em Áreas de Comunidades Tradicionais segundo o pagamento de parcelas do PDDE e a UF (Centro-Oeste, 2024)

```{r}
#| echo: false
#| warning: false
#| message: false

tab17 %>%
        kable(align = "l") %>%
        kable_styling(full_width = F, position = "left")%>%
        footnote(general = "Consulta Escola 2024; Censo Escolar 2023", general_title = "Fonte:")
```
